<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="group.css">
    
    
</head>
<body>
<div id="complete-profile-modal">
    <div class="modal-content">
        <h2 style="margin-top:0;">Welcome to Kabale Groups!</h2>
        <p style="color: var(--text-secondary); margin-bottom: 20px;">We need your public display name before you can join the chat.</p>
        <form id="complete-profile-form">
            <div class="form-group">
                <label for="profile-fullName-input">Your Full Name</label>
                <input type="text" id="profile-fullName-input" required>
            </div>
            <button type="submit" id="complete-profile-submit" class="create-group-btn" style="width: 100%; margin-top: 10px;">Save and Join Chat</button>
            <p style="text-align: center; font-size: 0.9em; color: var(--text-secondary); margin-top: 15px;">
                You can add more details (like your WhatsApp and bio) on your main <a href="/myprofile/" style="color: var(--ko-primary);">profile page</a> later.
            </p>
        </form>
    </div>
</div>
    <div class="chat-header">
        <a href="index.html" id="back-button"><i class="fas fa-arrow-left"></i></a>
        <div id="chat-header-info">
            <div class="group-icon-wrapper-sm">
                <div id="chat-header-placeholder" class="group-icon-placeholder-sm">G</div>
                <img id="chat-header-img" src="" alt="Group" class="group-icon-img-sm" style="display: none;">
            </div>
            <h2 id="chat-title">Group Chat</h2>
        </div>
    </div>

    <div id="message-area">
        </div>

    <div id="reply-banner">
        <button id="cancel-reply-btn">&times;</button>
        <p>Replying to <b id="reply-to-name">...</b></p>
        <p id="reply-to-preview">...</p>
    </div>

    <form id="chat-form">
        <input type="file" id="image-upload-input" accept="image/jpeg, image/png">
        <button type="button" id="image-upload-btn" title="Send Image">
            <i class="fas fa-paperclip"></i>
        </button>
        
        <input type="text" id="message-input" placeholder="Type a message..." autocomplete="off">
        
        <button type="submit"><i class="fas fa-paper-plane"></i></button>
    </form>
    
    
    <div id="group-details-modal">
        <div class="modal-header">
            <i id="modal-close-btn" class="fas fa-arrow-left modal-close-btn"></i>
            <h3 class="modal-title">Group Info</h3>
            <button id="modal-edit-btn" title="Edit Group"><i class="fas fa-pen"></i></button>
        </div>
        <div class="modal-body">
            <div class="group-profile-header">
                <img id="modal-group-img" src="https://placehold.co/150x150" alt="Group Profile">
                <h2 id="modal-group-name">...</h2>
                <p id="modal-group-description">...</p>
                <button id="share-group-btn">
                    <i class="fas fa-share-alt"></i> Share Group
                </button>
            </div>
            <div class="modal-section">
                <h4 class="modal-section-title">Members</h4>
                <div id="modal-members-list">
                    <div id="modal-members-loader" class="loader-small"></div>
                </div>
            </div>
            
            <div class="modal-section" id="danger-zone-section">
                <button id="leave-group-btn" class="danger-btn">
                    <i class="fas fa-sign-out-alt"></i> Leave Group
                </button>
            </div>
            
        </div>
    </div>
    
    <div id="edit-group-modal">
        <div class="modal-content">
            <span id="close-edit-modal-btn" class="close-btn">&times;</span>
            <h2 style="margin-top:0;">Edit Group Info</h2>
            <form id="edit-group-form">
                
                <input type="file" id="edit-group-image-input" accept="image/jpeg, image/png" style="display:none;">
                <div id="edit-group-image-upload-area" class="group-image-upload-area" title="Upload Group Image">
                    <div id="edit-group-image-preview-container"></div>
                    <i id="edit-group-image-upload-icon" class="fas fa-camera upload-icon"></i>
                </div>
                <div class="form-group">
                    <label for="edit-group-name">Group Name</label>
                    <input type="text" id="edit-group-name" required>
                </div>
                <div class="form-group">
                    <label for="edit-group-description">Description</label>
                    <input type="text" id="edit-group-description" required>
                </div>
                
                <div class="form-group">
                    <label for="edit-group-category">Category</label>
                    <select id="edit-group-category" required>
                        <option value="" disabled selected>Select a category</option>
                        <option value="Technology">Technology</option>
                        <option value="Housing">Housing</option>
                        <option value="Marketplace">Marketplace</option>
                        <option value="Events">Events</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <button type="submit" id="edit-group-submit" class="create-group-btn" style="width: 100%; margin-top: 10px;">Save Changes</button>
                <p id="edit-modal-error"></p>
            </form>
        </div>
    </div>
    
    <div id="edit-message-modal">
        <div class="modal-content">
            <h2 style="margin-top:0;">Edit Message</h2>
            <form id="edit-message-form">
                <div class="form-group">
                    <input type="text" id="edit-message-input" required>
                    <input type="hidden" id="edit-message-id-input">
                </div>
                <button type="submit" id="edit-message-submit" class="create-group-btn" style="width: 100%; margin-top: 10px;">Save Changes</button>
                <button type="button" id="close-edit-message-modal-btn" class="create-group-btn" style="width: 100%; margin-top: 10px; background: #555;">Cancel</button>
            </form>
        </div>
    </div>
    
    <div id="image-popup-modal">
        <span id="close-image-popup">&times;</span>
        <img id="popup-image" src="" alt="Popup Image">
    </div>

    <div id="toast-notification">Link copied to clipboard!</div>
<div id="context-menu-overlay"></div>
    <div id="message-context-menu">
        
        <div id="menu-reaction-bar">
            <button class="reaction-btn" data-reaction="‚ù§Ô∏è">‚ù§Ô∏è</button>
            <button class="reaction-btn" data-reaction="üëç">üëç</button>
            <button class="reaction-btn" data-reaction="üòÇ">üòÇ</button>
            <button class="reaction-btn" data-reaction="üòÆ">üòÆ</button>
            <button class="reaction-btn" data-reaction="üò¢">üò¢</button>
            <button class="reaction-btn" data-reaction="üôè">üôè</button>
        </div>
        <button id="menu-reply-btn"><i class="fas fa-reply"></i> Reply</button>
        <button id="menu-edit-btn"><i class="fas fa-pen"></i> Edit</button>
        <button id="menu-delete-btn" class="menu-danger">
            <i class="fas fa-trash"></i> Delete
        </button>
    </div>
    
    <script type="module" src="../firebase.js"></script>
    <script type="module" src="chat.js?v=11"></script> 
</body>
</html>