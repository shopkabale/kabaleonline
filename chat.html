<!DOCTYPE html>
<html lang="en">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5XQRYNC9TW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5XQRYNC9TW');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat | Kabale Online</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
      /* ‚≠ê Review Stars Highlight Fix */
      .star {
        cursor: pointer;
        font-size: 2rem;
        color: gray;
        transition: color 0.2s;
      }
      .star:hover,
      .star.selected {
        color: gold;
      }
    </style>
</head>
<body>

    <div class="mobile-nav-overlay"></div>
    <header class="sticky-header">
        <div class="header-top-bar">
            <button class="hamburger-menu" aria-label="Open menu">&#9776;</button>
            <a href="/" class="site-title">Kabale <span>Online</span></a>
            <div class="header-spacer"></div>
            <div class="header-icons">
                <a href="/inbox.html" aria-label="Notifications" class="notification-bell" id="notification-bell">
                    <i class="fa-regular fa-bell"></i>
                    <span class="notification-count" id="notification-count" style="display: none;">0</span>
                </a>
                <a href="/sell/" aria-label="Your Dashboard"><i class="fa-regular fa-user"></i></a>
            </div>
        </div>
    </header>

    <nav class="mobile-nav">
        <div class="mobile-nav-header">Kabale Online</div>
        <div class="mobile-nav-links">
            <a href="/" class="nav-link"><i class="fa-solid fa-store"></i> All Items</a>
            <a href="/?type=service" class="nav-link"><i class="fa-solid fa-screwdriver-wrench"></i> Services</a>
            <a href="/wishlist.html" class="nav-link"><i class="fa-solid fa-heart"></i> My Wishlist</a>
            <a href="/inbox.html" class="nav-link"><i class="fa-solid fa-inbox"></i> My Inbox</a>
        </div>
        <div class="mobile-nav-footer">
            <a href="/sell/" class="post-button">Post Something Free</a>
        </div>
    </nav>

    <div class="container page-container">
        <main>
            <h1 id="chat-recipient-name">Loading Chat...</h1>
            <div id="chat-messages" class="chat-messages">
                <p style="text-align:center;color:gray;">Loading messages...</p>
            </div>
            <form id="chat-form" class="chat-form">
                <input type="text" id="message-input" placeholder="Type a message..." required autocomplete="off">
                <button type="submit">Send</button>
            </form>
             <button id="review-modal-btn" style="margin:1rem 0; padding:0.8rem 1rem;border:none;border-radius:5px;background:#ffc107;color:#fff;cursor:pointer; width: 100%;">Leave a Review</button>
        </main>
    </div>

    <div id="review-modal" class="modal" style="display:none; position:fixed; top:0;left:0;right:0;bottom:0; background:rgba(0,0,0,0.6); justify-content:center; align-items:center; z-index: 2000;">
      <div class="modal-content" style="background:#fff; padding:1.5rem; border-radius:12px; max-width:400px; width:90%;">
        <h2>Leave a Review for <span id="review-recipient-name"></span></h2>
        <div id="star-rating" style="display:flex; margin-bottom:1rem; font-size: 2rem;">
          <span class="star" data-value="1">&#9733;</span>
          <span class="star" data-value="2">&#9733;</span>
          <span class="star" data-value="3">&#9733;</span>
          <span class="star" data-value="4">&#9733;</span>
          <span class="star" data-value="5">&#9733;</span>
        </div>
        <form id="review-form">
          <textarea id="review-text" placeholder="Write a review..." style="width:100%; min-height:80px; margin-bottom:1rem; padding:0.5rem; border-radius:5px; border:1px solid #ccc;"></textarea>
          <button id="submit-review-btn" type="submit" style="padding:0.7rem 1rem; border:none; border-radius:5px; background:#28a745; color:#fff; cursor:pointer;">Submit</button>
          <button type="button" id="cancel-review-btn" style="padding:0.7rem 1rem; border:none; border-radius:5px; background:#dc3545; color:#fff; cursor:pointer;">Cancel</button>
          <p id="review-form-message"></p>
        </form>
      </div>
    </div>

    <footer>
        <div class="container">
            <div class="footer-logo">Kabale <span>Online</span></div>
            <p class="footer-tagline">Your Community Marketplace</p>
            <div class="footer-socials">
                <a href="https://chat.whatsapp.com/IfxLBcDErhlCIMg8x4UG9y?mode=ems_copy_c" target="_blank" aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
            </div>
            <div class="footer-links">
                <a href="/about.html">About</a>
                <a href="/blog/">Blog</a>
                <a href="/terms.html">Terms</a>
            </div>
            <p class="footer-copyright">&copy; 2025 Kabale Online. All Rights Reserved.</p>
        </div>
<!-- Modal notification for Services link -->
<div id="service-notice" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
  background:rgba(0,0,0,0.6); justify-content:center; align-items:center; z-index:1000;">
  <div style="background:#fff; padding:30px 40px; border-radius:12px; text-align:center; max-width:400px; 
    box-shadow:0 5px 20px rgba(0,0,0,0.3); font-family:Arial,sans-serif; animation:fadeIn 0.3s ease-out;">
    <h3 style="margin-bottom:15px; color:#333;">Notice</h3>
    <p style="margin-bottom:20px; color:#555;">You are being redirected to <strong>Gigs.kabaleonline.com</strong> for Services.</p>
    <button id="continue-btn" style="padding:10px 20px; background:#007bff; border:none; border-radius:8px; 
      color:#fff; font-weight:bold; cursor:pointer; transition:background 0.3s;">Continue</button>
  </div>
</div>

<style>
@keyframes fadeIn {
  from { opacity:0; transform: scale(0.8); }
  to { opacity:1; transform: scale(1); }
}
#continue-btn:hover {
  background:#0056b3;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Select all links pointing to /?type=service
  const serviceLinks = document.querySelectorAll('a[href="/?type=service"]');
  const modal = document.getElementById('service-notice');
  const continueBtn = document.getElementById('continue-btn');

  serviceLinks.forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault(); // Stop default navigation
      modal.style.display = 'flex'; // Show modal
    });
  });

  continueBtn.addEventListener('click', function() {
    window.location.href = 'https://gigs.kabaleonline.com';
  });

  // Optional: click outside modal content to close
  modal.addEventListener('click', function(e) {
    if(e.target === modal) modal.style.display = 'none';
  });
});
</script>
    </footer>

    <div id="pwa-banner">
      <div>
        <strong>KABALE ONLINE APP</strong>
        <span>Install Kabale Online for faster access, offline use, and under 1 MB!</span>
        <div class="button-container">
          <button id="pwa-install-btn">Install</button>
          <button id="pwa-cancel-btn">Cancel</button>
        </div>
      </div>
    </div>

    <script type="module" src="ui.js"></script>
    <script type="module" src="shared.js"></script>
    <script type="module" src="chat.js"></script>
</body>
</html>