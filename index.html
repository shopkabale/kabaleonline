<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5XQRYNC9TW"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-5XQRYNC9TW');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- (All your SEO and meta tags are preserved here) -->
    <title>Buy & Sell, Find Hostels, Services & Events in Kabale | Kabale Online</title>
    <meta name="description" content="Your one-stop platform for Kabale. Buy & sell anything from electronics to textbooks, find student hostels and rentals, discover local services, post events, and check the lost & found.">
    <meta name="keywords" content="kabale student hostels, find a job in kabale, local services kabale, kabale events calendar, lost and found kabale uganda, buy used phone kabale, kigezi marketplace, Kabale campus market, buy and sell online, events in kabale, services in kabale, kabale Uganda, Campus Mart">
    <meta name="author" content="Kabale Online">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://www.kabaleonline.com/">

    <meta property="og:title" content="Kabale Online: The #1 Platform for Items, Rentals, Services & More">
    <meta property="og:description" content="The community marketplace for students and residents in Kabale to buy, sell, rent, and discover everything local.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.kabaleonline.com/">
    <meta property="og:image" content="https://www.kabaleonline.com/assets/social-share-image.jpg">
    <meta property="og:site_name" content="Kabale Online">
    <meta property="og:locale" content="en_UG">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Kabale Online | The #1 Marketplace in Kabale">
    <meta name="twitter:description" content="Buy, sell, rent, and discover everything in Kabale. From electronics to hostels, find what you need in your community.">
    <meta name="twitter:image" content="https://www.kabaleonline.com/assets/social-share-image.jpg">
    <meta name="twitter:site" content="@kabaleonline">

    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#007bff">
    <link rel="icon" href="/favicon.webp" type="image/webp">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
    <script>
      window.OneSignalDeferred = window.OneSignalDeferred || [];
      OneSignalDeferred.push(async function(OneSignal) {
        await OneSignal.init({ appId: "46fb657e-75a2-4140-9d08-69a746055814" });
      });
    </script>

    <!-- (Your schema.org scripts are preserved here) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Kabale Online",
      "url": "https://www.kabaleonline.com/",
      "potentialAction": {
        "@type": "SearchAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": "https://www.kabaleonline.com/?q={search_term_string}"
        },
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Kabale Online",
      "url": "https://www.kabaleonline.com/",
      "logo": "https://www.kabaleonline.com/icons/512.png",
      "sameAs": [
        "https://facebook.com/kabaleonline",
        "https://twitter.com/kabaleonline",
        "https://chat.whatsapp.com/IfxLBcDErhlCIMg8x4UG9y?mode=ems_copy_c"
      ]
    }
    </script>

    <style>
        /* --- THEME-AWARE CSS VARIABLES --- */
        :root {
            --ko-primary: #007aff;
            --ko-primary-rgb: 0, 122, 255;
            --ko-accent: #ffc107;
            --bg-light: #f8f9fa;
            --bg-card-light: #ffffff;
            --text-main-light: #212529;
            --text-secondary-light: #6c757d;
            --border-color-light: #e9ecef;
            --bg-dark: #0f172a;
            --bg-card-dark: #1e2b3b;
            --text-main-dark: #e2e8f0;
            --text-secondary-dark: #94a3b8;
            --border-color-dark: #334155;
            --shadow: 0 10px 30px rgba(0,0,0,0.07);
            --border-radius: 12px;
        }
        body.light-mode {
            --bg-main: var(--bg-light); --bg-card: var(--bg-card-light); --text-main: var(--text-main-light);
            --text-secondary: var(--text-secondary-light); --border-color: var(--border-color-light);
        }
        body.dark-mode {
            --bg-main: var(--bg-dark); --bg-card: var(--bg-card-dark); --text-main: var(--text-main-dark);
            --text-secondary: var(--text-secondary-dark); --border-color: var(--border-color-dark);
        }

        /* --- GLOBAL STYLES --- */
        body { 
            font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            margin: 0; 
            background-color: var(--bg-main); 
            color: var(--text-main); 
            line-height: 1.6; 
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 15px; }
        .section-title { 
            font-size: 1.5em; 
            font-weight: 700;
            margin: 0;
        }

        /* --- NEW: SCROLL PROGRESS BAR --- */
        #scroll-progress-bar {
            position: fixed;
            top: 70px; /* Below the sticky header */
            left: 0;
            width: 0%;
            height: 4px;
            background-color: var(--ko-primary);
            z-index: 999;
            transition: width 0.1s ease-out;
        }
        @media (max-width: 1023px) {
            #scroll-progress-bar {
                top: auto;
                bottom: 0; /* At the bottom on mobile */
            }
        }

        /* --- HEADER & NAV --- */
        .sticky-header {
            position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
            background-color: rgba(var(--bg-card-rgb, 30, 41, 59), 0.8);
            backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
        }
        body.light-mode .sticky-header { --bg-card-rgb: 255, 255, 255; }
        body.dark-mode .sticky-header { --bg-card-rgb: 30, 41, 59; }
        .header-content { display: flex; align-items: center; justify-content: space-between; height: 70px; }
        .site-title { text-decoration: none; color: var(--text-main); font-size: 1.5em; font-weight: 700; }
        .site-title span { color: var(--ko-accent); }
        .hamburger-menu { font-size: 24px; background: none; border: none; cursor: pointer; color: var(--text-main); display: block; }
        .header-icons { display: flex; align-items: center; gap: 20px; }
        .header-icons a { color: var(--text-secondary); font-size: 22px; text-decoration: none; }
        .desktop-nav { display: none; } 
        @media (min-width: 1024px) { 
            .hamburger-menu { display: none !important; } 
            .desktop-nav { display: flex; align-items: center; gap: 25px; list-style: none; margin: 0; padding: 0;} 
            .desktop-nav a { text-decoration: none; color: var(--text-secondary); font-weight: 500; } 
        }
        
        /* Mobile Nav */
        .mobile-nav-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1090; opacity: 0; visibility: hidden; }
        .mobile-nav-overlay.active { opacity: 1; visibility: visible; }
        .mobile-nav { position: fixed; top: 0; left: -280px; width: 280px; height: 100%; background-color: var(--bg-card); z-index: 1100; transition: transform 0.3s ease; display: flex; flex-direction: column; }
        .mobile-nav.active { transform: translateX(280px); }
        .mobile-nav-header { padding: 15px 20px; border-bottom: 1px solid var(--border-color); font-size: 1.2em; font-weight: bold; }
        .mobile-nav a { display: flex; align-items: center; padding: 16px 20px; color: var(--text-main); text-decoration: none; border-bottom: 1px solid var(--border-color); }
        .mobile-nav a i { margin-right: 15px; color: var(--ko-primary); }
        .mobile-nav-footer { padding: 15px; }
        .mobile-nav .post-button { background-color: var(--ko-accent); color: #212529; font-weight: bold; border-radius: 25px; text-align: center; display: block; padding: 12px; text-decoration: none; }

        /* Theme Toggle */
        .theme-switch-wrapper { display: flex; align-items: center; }
        .theme-switch { position: relative; display: inline-block; width: 50px; height: 26px; }
        .theme-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--ko-primary); }
        input:checked + .slider:before { transform: translateX(24px); }
        .theme-hint-text { display: none; } 
        
        /* --- HERO SECTION --- */
        .hero { padding: 25px 0; background-color: var(--bg-card); border-bottom: 1px solid var(--border-color); margin-top: 70px; }
        .hero-search-form { display: flex; max-width: 600px; margin: 0 auto; position: relative; }
        #hero-search-input { width: 100%; padding: 12px 20px; font-size: 1em; border: 1px solid var(--border-color); border-right: none; border-radius: 25px 0 0 25px; background-color: var(--bg-main); color: var(--text-main); }
        .hero-search-form button { padding: 12px 22px; border: 1px solid var(--ko-primary); background-color: var(--ko-primary); color: white; cursor: pointer; border-radius: 0 25px 25px 0; }

        /* --- NEW: Search Placeholder Animation --- */
        #hero-search-input::placeholder {
            color: var(--text-secondary);
            opacity: 1;
            transition: opacity 0.3s ease;
        }
        #hero-search-input.placeholder-hidden::placeholder {
            opacity: 0;
        }
        
        /* --- 2-COLUMN PAGE LAYOUT --- */
        .page-layout {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
        }
        .sidebar { flex-basis: 260px; flex-shrink: 0; }
        .main-content { flex-grow: 1; }
        @media (min-width: 992px) {
            .page-layout { flex-direction: row; }
        }
        
        /* --- CATEGORY SIDEBAR STYLES --- */
        .category-widget {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }
        .category-widget h3 { margin: 0; padding: 15px 20px; border-bottom: 1px solid var(--border-color); font-size: 1.1em; }
        .category-list { list-style: none; padding: 0; margin: 0; }
        .category-list a { display: flex; align-items: center; gap: 12px; padding: 14px 20px; text-decoration: none; color: var(--text-main); border-bottom: 1px solid var(--border-color); font-weight: 500; }
        .category-list li:last-child a { border-bottom: none; }
        .category-list a:hover { background-color: var(--bg-main); }
        .category-list i { font-size: 1.1em; width: 20px; text-align: center; color: var(--text-secondary); }
        .category-list a:hover i { color: var(--ko-primary); }
        
        /* --- SECTION HEADER WITH "SEE MORE" --- */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
        }
        .see-more-btn {
            color: var(--ko-primary);
            font-weight: 600;
            font-size: 0.9em;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 6px;
            transition: background-color 0.2s ease;
            white-space: nowrap; 
            border: 1px solid transparent;
            background-color: var(--bg-main);
            cursor: pointer;
        }
        .see-more-btn:hover { background-color: var(--border-color); }
        
        /* --- PRODUCT CAROUSEL --- */
        .product-carousel-section {
            background-color: var(--bg-card);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow);
        }
        .product-carousel-wrapper { overflow-x: auto; padding-bottom: 15px; scrollbar-width: none; -webkit-overflow-scrolling: touch;}
        .product-carousel-wrapper::-webkit-scrollbar { display: none; }
        .product-carousel { display: flex; gap: 15px; }
        .product-carousel .product-card { flex: 0 0 160px; width: 160px; }
        @media (min-width: 768px) { .product-carousel .product-card { flex: 0 0 200px; width: 200px; } }

        /* --- RECENT ITEMS GRID (2x2) --- */
        .recent-products-section {
            background-color: var(--bg-card);
            border-radius: var(--border-radius);
            padding: 20px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow);
        }
        .product-grid { 
            display: grid; 
            gap: 20px; 
            grid-template-columns: repeat(2, 1fr); /* 2x2 Grid */
        }
        /* MODIFIED: Don't change grid on desktop, keep it 2x2 unless more are loaded */
        @media (min-width: 768px) { 
            .product-grid { grid-template-columns: repeat(2, 1fr); } 
            .product-grid.expanded {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
        }
        
        /* --- CTA Button & Description --- */
        .shop-cta-container-spaced {
            text-align: center;
            margin-top: 20px;
            margin-bottom: 60px; /* NEW: Added space above footer */
            padding: 0 10px;
        }
        .shop-cta-description {
            font-size: 1em;
            color: var(--text-secondary);
            margin: 0 auto 20px;
            max-width: 500px;
            line-height: 1.7;
        }
        .shop-cta-btn {
            display: block; 
            width: 100%;
            background-color: var(--ko-primary);
            color: white;
            font-weight: 600;
            font-size: 1.1em;
            padding: 14px 30px; 
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.2s ease;
            box-sizing: border-box; 
        }
        .shop-cta-btn:hover {
            background-color: #0056b3; 
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        @media (min-width: 992px) {
            .shop-cta-container-spaced { padding: 0; }
            .shop-cta-btn {
                display: inline-block; 
                width: auto;
            }
        }
        
        /* --- PRODUCT CARD STYLES --- */
        .product-card-link { text-decoration: none; color: inherit; }
        .product-card { background: var(--bg-main); border-radius: var(--border-radius); overflow: hidden; display: flex; flex-direction: column; height: 100%; box-shadow: 0 2px 8px rgba(0,0,0,0.05); position: relative; transition: all 0.3s ease-out; border: 1px solid var(--border-color); }
        .product-card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.1); }
        .product-card img.lazy-load { 
            width: 100%; 
            aspect-ratio: 1 / 1; 
            object-fit: cover; 
            background-color: var(--border-color);
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .product-card img.loaded { opacity: 1; }
        .product-card h3 { margin: 10px 15px; font-size: 0.95rem; flex-grow: 1; }
        .product-card .price { margin: 0 15px 15px; font-size: 1.1rem; font-weight: bold; color: var(--ko-primary); }
        
        .product-card h3,
        .product-card .location-name,
        .product-card .seller-name {
            overflow-wrap: break-word;
            word-break: break-all;
        }

        .product-card .location-name { font-size: 0.85em; color: var(--text-secondary); margin: -10px 15px 5px; }
        .product-card .location-name i { margin-right: 5px; color: var(--ko-primary); }
        .product-card .seller-name { font-size: 0.85em; color: var(--text-secondary); margin: 0 15px 10px; }
        
        /* Using text-based verified badge as per last request */
        .product-card .verified-text {
            font-size: 0.8em;
            font-weight: 700;
            color: var(--ko-primary);
            background-color: rgba(var(--ko-primary-rgb), 0.1);
            border: 1px solid rgba(var(--ko-primary-rgb), 0.2);
            padding: 3px 10px;
            border-radius: 20px;
            display: inline-block;
            margin: 0 15px 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .product-tags { position: absolute; top: 12px; left: 12px; z-index: 3; display: flex; flex-direction: column; gap: 6px; }
        .product-tag { background-color: rgba(0, 0, 0, 0.7); color: white; padding: 3px 8px; border-radius: 4px; font-size: 0.75em; font-weight: 700; text-transform: uppercase; }
        .product-tag.type-rent { background-color: var(--ko-primary); }
        .product-tag.type-sale { background-color: #6c757d; }
        .product-tag.condition-new { background-color: #28a745; }
        .product-tag.condition-used { background-color: var(--ko-accent); color: #212529; }
        
        .product-card .wishlist-btn { position: absolute; top: 12px; right: 12px; background-color: rgba(255, 255, 255, 0.8); border: none; border-radius: 50%; width: 36px; height: 36px; display: flex; justify-content: center; align-items: center; cursor: pointer; font-size: 18px; color: var(--text-main); z-index: 3; }
        
        .stock-info { font-size: 0.85em; font-weight: bold; margin: -10px 15px 10px; padding: 3px 8px; border-radius: 4px; display: inline-block; }
        .in-stock { color: #155724; background-color: #d4edda; }
        .low-stock { color: #856404; background-color: #fff3cd; }
        .out-of-stock, .sold-out { color: #721c24; background-color: #f8d7da; }
        .product-card.is-sold img { filter: grayscale(90%); }

        .skeleton-card { background: var(--bg-card); border-radius: var(--border-radius); overflow: hidden; display: flex; flex-direction: column; height: 100%; box-shadow: var(--shadow); position: relative; border: 1px solid var(--border-color); }
        .skeleton-image, .skeleton-text { background-color: #e0e0e0; background-image: linear-gradient(90deg, #e0e0e0, #f0f0f0, #e0e0e0); background-size: 250px; animation: skeleton-shimmer 1.5s infinite linear; }
        body.dark-mode .skeleton-card, body.dark-mode .skeleton-image, body.dark-mode .skeleton-text { background-color: #334155; background-image: linear-gradient(90deg, #334155, #475569, #334155); }
        .skeleton-image { width: 100%; aspect-ratio: 1 / 1; }
        .skeleton-text { height: 1.2rem; margin: 12px 15px 0; border-radius: 4px; }
        @keyframes skeleton-shimmer { 100% { background-position: 250px; } }
        
        /* --- NEW: MASSIVE FOOTER STYLES --- */
        footer { 
            background-color: #0f172a; 
            color: #e2e8f0; 
            padding: 60px 0 20px; 
            margin-top: 30px; 
            border-top: 4px solid var(--ko-primary);
        }
        .footer-grid { 
            display: grid; 
            grid-template-columns: 1fr; 
            gap: 40px; 
            padding-bottom: 40px; 
            /* NEW: Scroll Animation */
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .footer-grid.in-view {
            opacity: 1;
            transform: translateY(0);
        }
        .footer-column { text-align: left; }
        .footer-column h3 { font-size: 1.1em; font-weight: 600; color: #ffffff; margin-top: 0; margin-bottom: 20px; position: relative; padding-bottom: 10px; }
        .footer-column h3::after { content: ''; position: absolute; bottom: 0; left: 0; width: 30px; height: 2px; background-color: var(--ko-accent); }
        .footer-column a { display: block; color: #94a3b8; text-decoration: none; margin-bottom: 12px; }
        .footer-column a:hover { color: #ffffff; }
        
        .footer-logo { font-size: 1.8em; font-weight: bold; margin-bottom: 15px; text-decoration: none; color: #ffffff; display: inline-block; }
        .footer-logo span { color: var(--ko-accent); }
        .footer-tagline { color: #94a3b8; line-height: 1.7; margin-bottom: 20px; }
        
        /* NEW: Social Links Redesign */
        .footer-socials a { 
            display: flex; 
            align-items: center;
            gap: 10px;
            color: #e2e8f0; 
            font-size: 1.1em; 
            margin-bottom: 15px; 
            text-decoration: none; 
            transition: color 0.2s ease;
        }
        .footer-socials a i {
            font-size: 1.6em;
            width: 30px;
        }
        .footer-socials a:hover { color: var(--ko-primary); }

        .footer-bottom { border-top: 1px solid #334155; padding-top: 20px; text-align: center; }
        .footer-copyright { font-size: 0.9em; color: #64748b; margin: 0; }
        
        @media (min-width: 768px) { .footer-grid { grid-template-columns: repeat(2, 1fr); } }
        @media (min-width: 1024px) { .footer-grid { grid-template-columns: 2fr 1fr 1fr 1fr; } }
        /* --- END FOOTER --- */
        
        /* --- MODALS (PRESERVED) --- */
        .nav-modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); justify-content: center; align-items: center; }
        .nav-modal-content { background-color: var(--bg-card); padding: 30px; border-radius: var(--border-radius); text-align: center; max-width: 400px; width: 90%; }
        .nav-modal-buttons { display: flex; gap: 10px; justify-content: center; margin-top: 20px; }
        .nav-modal-btn { padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 600; cursor: pointer; border: none; }
        .btn-cancel { background-color: var(--bg-main); color: var(--text-main); border: 1px solid var(--border-color); }
        .btn-confirm { background-color: var(--ko-primary); color: white; }
        
        /* --- NEW: AI Chat Bubble --- */
        .ai-chat-bubble {
            position: fixed;
            bottom: 25px;
            right: 25px;
            z-index: 998;
            background-color: var(--bg-card);
            color: var(--text-main);
            padding: 12px 16px;
            border-radius: 16px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            border: 1px solid var(--border-color);
            transform: translateY(20px);
            opacity: 0;
            animation: slideUp 0.5s 1s ease forwards;
        }
        @keyframes slideUp { to { transform: translateY(0); opacity: 1; } }
        .ai-chat-bubble.dismissed { display: none; }
        .ai-chat-bubble-avatar {
            flex-shrink: 0;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--ko-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3em;
        }
        .ai-chat-bubble-text { font-size: 0.9em; font-weight: 500; margin-right: 15px; }
        #ai-bubble-close {
            position: absolute;
            top: 6px;
            right: 8px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.2em;
            cursor: pointer;
            padding: 2px;
        }
        
        #chat-modal-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000; display: none; align-items: center; justify-content: center; }
        .chat-modal-overlay { position: absolute; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); opacity: 0; transition: opacity 0.3s ease; }
        .chat-modal-content { position: relative; z-index: 1001; width: 90%; max-width: 420px; height: 80%; max-height: 700px; background-color: var(--bg-card); border-radius: var(--border-radius); box-shadow: 0 10px 30px rgba(0,0,0,0.2); display: flex; flex-direction: column; overflow: hidden; transform: scale(0.95); opacity: 0; transition: transform 0.3s ease, opacity 0.3s ease; }
        .chat-modal-header { display: flex; justify-content: space-between; align-items: center; padding: 10px 20px; border-bottom: 1px solid var(--border-color); flex-shrink: 0; }
        .chat-modal-header h3 { margin: 0; font-size: 1.2em; color: var(--text-main); }
        #close-chat-button { background: none; border: none; font-size: 24px; color: var(--text-secondary); cursor: pointer; padding: 5px; }
        #chat-iframe { width: 100%; height: 100%; border: none; }
        #chat-modal-container.active { display: flex; }
        #chat-modal-container.active .chat-modal-overlay { opacity: 1; }
        #chat-modal-container.active .chat-modal-content { transform: scale(1); opacity: 1; }
    </style>
</head>
<body class="light-mode">

    <!-- NEW: Scroll Progress Bar -->
    <div id="scroll-progress-bar"></div>

    <script src="theme.js"></script>

    <header class="sticky-header">
        <div class="container">
            <div class="header-content">
                <a href="/" class="site-title">Kabale <span>Online</span></a>
                <nav class="desktop-nav">
                    <a href="/shop/" class="nav-link active">Shop</a>
                    <a href="/rentals/" class="nav-link">Hostels</a>
                    <a href="https://gigs.kabaleonline.com" class="nav-link service-link">Services</a>
                    <a href="/events/" class="nav-link">Events</a>
                    <a href="/lost-and-found/" class="nav-link">Lost & Found</a>
                </nav>
                <div class="header-icons">
                    <div class="theme-switch-wrapper">
                        <label class="theme-switch" for="theme-toggle">
                            <input type="checkbox" id="theme-toggle" />
                            <span class="slider"></span>
                            <span id="theme-hint" class="theme-hint-text"></span>
                        </label>
                    </div>
                    <a href="/cart.html" aria-label="Cart"><i class="fas fa-shopping-cart"></i></a>
                    <a href="/dashboard/" aria-label="Dashboard"><i class="fas fa-user"></i></a>
                    <button class="hamburger-menu" aria-label="Open menu">&#9776;</button>
                </div>
            </div>
        </div>
    </header>

    <nav class="mobile-nav">
        <!-- (Your mobile nav links) -->
        <div class="mobile-nav-header">Kabale Online</div>
        <div class="mobile-nav-links">
            <a href="/shop/" class="nav-link"><i class="fa-solid fa-store"></i> All Items</a>
            <a href="https://gigs.kabaleonline.com" class="nav-link service-link"><i class="fa-solid fa-screwdriver-wrench"></i> Services</a>
            <a href="/events/" class="nav-link"><i class="fa-solid fa-calendar-days"></i> Events</a>
            <a href="stories.html" class="nav-link"><i class="fa-solid fa-book-open"></i> Campus Stories</a>
            <a href="/wishlist.html" class="nav-link"><i class="fa-solid fa-heart"></i> My Wishlist</a>
            <a href="/cart.html" class="nav-link"><i class="fa-solid fa-cart-shopping"></i> My Cart</a>
            <a href="/my-orders.html" class="nav-link"><i class="fa-solid fa-box"></i> My Orders</a>
            <a href="/inbox.html" class="nav-link"><i class="fa-solid fa-inbox"></i> My Inbox</a>
            <a href="/rentals/" class="nav-link"><i class="fa-solid fa-building"></i> Hostels & Rentals</a>
            <a href="/requests/view.html" class="nav-link"><i class="fa-solid fa-clipboard-list"></i> User Requests</a>
            <a href="/lost-and-found/" class="nav-link"><i class="fa-solid fa-magnifying-glass-plus"></i> Lost & Found</a>
        </div>
        <div class="mobile-nav-footer">
            <a href="/dashboard/" class="post-button">Post Something Free</a>
        </div>
    </nav>
    <div class="mobile-nav-overlay"></div>

    <main>
        <!-- HERO WITH ANIMATED SEARCH -->
        <section class="hero">
            <div class="container">
                <form class="hero-search-form" action="/shop/" method="get">
                    <input type="search" name="q" id="hero-search-input" aria-label="Search" placeholder="Search laptops...">
                    <button type="submit" aria-label="Submit search"><i class="fas fa-search"></i></button>
                </form>
            </div>
        </section>

        <!-- NEW 2-COLUMN LAYOUT -->
        <div class="container page-layout">
        
            <!-- NEW SIDEBAR -->
            <aside class="sidebar">
                <div class="category-widget">
                    <h3>Categories</h3>
                    <ul class="category-list">
                        <li><a href="/shop/?category=Electronics"><i class="fa-solid fa-laptop"></i> Electronics</a></li>
                        <li><a href="/shop/?category=Clothing+%26+Apparel"><i class="fa-solid fa-shirt"></i> Clothing</a></li>
                        <li><a href="/shop/?category=Home+%26+Furniture"><i class="fa-solid fa-couch"></i> Furniture</a></li>
                        <li><a href="/rentals/"><i class="fa-solid fa-building"></i> Hostels & Rentals</a></li>
                        <li><a href="https://gigs.kabaleonline.com" class="service-link"><i class="fa-solid fa-screwdriver-wrench"></i> Services</a></li>
                        <li><a href="/shop/?category=Other"><i class="fa-solid fa-ellipsis"></i> Other</a></li>
                    </ul>
                </div>
            </aside>
            
            <!-- NEW MAIN CONTENT AREA -->
            <main class="main-content">
            
                <!-- FEATURED ITEMS -->
                <section id="featured-section" class="product-carousel-section" style="display: none;">
                    <div class="section-header">
                        <h2 class="section-title">Featured Items</h2>
                        <a href="/shop/?filter=hero" class="see-all-btn">See All &rarr;</a>
                    </div>
                    <div class="product-carousel-wrapper">
                        <div class="product-carousel" id="featured-products-grid">
                            <!-- JS will populate this -->
                        </div>
                    </div>
                </section>
                
                <!-- DEALS SECTION -->
                <section id="deals-section" class="product-carousel-section" style="display: none;">
                     <div class="section-header">
                        <h2 class="section-title">Today's Deals</h2>
                        <a href="/shop/?filter=deals" class="see-all-btn">See All &rarr;</a>
                    </div>
                    <div class="product-carousel-wrapper">
                        <div class="product-carousel" id="deals-grid">
                            <!-- JS will populate this -->
                        </div>
                    </div>
                </section>
                
                <!-- SPONSORED SECTION -->
                <section id="sponsored-section" class="product-carousel-section" style="display: none;">
                     <div class="section-header">
                        <h2 class="section-title">Sponsored</h2>
                        <a href="/shop/?filter=sponsored" class="see-all-btn">See All &rarr;</a>
                    </div>
                    <div class="product-carousel-wrapper">
                        <div class="product-carousel" id="sponsored-grid">
                            <!-- JS will populate this -->
                        </div>
                    </div>
                </section>
                
                <!-- SAVE ON MORE SECTION -->
                <section id="save-on-more-section" class="product-carousel-section" style="display: none;">
                     <div class="section-header">
                        <h2 class="section-title">Save On More</h2>
                        <a href="/shop/?filter=save" class="see-all-btn">See All &rarr;</a>
                    </div>
                    <div class="product-carousel-wrapper">
                        <div class="product-carousel" id="save-on-more-grid">
                            <!-- JS will populate this -->
                        </div>
                    </div>
                </section>
                
                <!-- RECENT ITEMS SECTION (2x2 GRID) -->
                <section class="recent-products-section">
                    <div class="section-header">
                        <h2 class="section-title">Recent Items</h2>
                        <!-- NEW "See More" button -->
                        <button class="see-more-btn" id="see-more-recent" data-next-page="1" data-expanded="false">
                            See More &darr;
                        </button>
                    </div>
                    <div class="product-grid" id="recent-products-grid">
                        <!-- Skeletons for loading -->
                        <div class="product-card skeleton-card"><div class="skeleton-image"></div><div class="skeleton-text"></div></div>
                        <div class="product-card skeleton-card"><div class="skeleton-image"></div><div class="skeleton-text"></div></div>
                        <div class="product-card skeleton-card"><div class="skeleton-image"></div><div class="skeleton-text"></div></div>
                        <div class="product-card skeleton-card"><div class="skeleton-image"></div><div class="skeleton-text"></div></div>
                    </div>
                </section>

                <!-- NEW: CTA Button to Shop Page (with new spacing class) -->
                <div class="shop-cta-container-spaced">
                    <!-- NEW: Description added -->
                    <p class="shop-cta-description">
                        Welcome to the Kabale Online marketplace.
                        We connect students and residents to buy, sell, and rent items.
                        Find textbooks, electronics, or even a new hostel.
                        Click below to explore all items available right now.
                    </p>
                    <a href="/shop/" class="shop-cta-btn">
                        Browse All Products
                    </a>
                </div>
                
            </main>
        
        </div> <!-- End .page-layout -->

    </main>

    <footer class="container">
        <!-- NEW: "Massive" Footer Design -->
        <div class="footer-grid">
            <div class="footer-column about-column">
                <a href="/" class="footer-logo">Kabale <span>Online</span></a>
                <p class="footer-tagline">The #1 community marketplace for students and residents in Kabale.</p>
                <div class="footer-socials">
                    <!-- NEW: Redesigned Socials -->
                    <a href="https://chat.whatsapp.com/IfxLBcDErhlCIMg8x4UG9y?mode=ems_copy_c" target="_blank" aria-label="WhatsApp">
                        <i class="fab fa-whatsapp"></i>
                        <span>WhatsApp Group</span>
                    </a>
                    <!-- Add your real number here -->
                    <a href="https://wa.me/256700000000" target="_blank" aria-label="WhatsApp Support">
                        <i class="fab fa-whatsapp"></i>
                        <span>+256 700 000 000</span>
                    </a>
                    <a href="https://twitter.com/kabaleonline" target="_blank" aria-label="Twitter">
                        <i class="fab fa-twitter"></i>
                        <span>Kabale Online on X</span>
                    </a>
                    <a href="https://facebook.com/kabaleonline" target="_blank" aria-label="Facebook">
                        <i class="fab fa-facebook-f"></i>
                        <span>Kabale Online on Facebook</span>
                    </a>
                </div>
            </div>
            <div class="footer-column">
                <h3>Explore</h3>
                <a href="/shop/">Shop Items</a>
                <a href="/rentals/">Hostels & Rentals</a>
                <a href="https://gigs.kabaleonline.com" class="service-link">Find Services</a>
                <a href="/events/">Local Events</a>
                <a href="/lost-and-found/">Lost & Found</a>
            </div>
            <div class="footer-column">
                <h3>For Sellers</h3>
                <a href="/upload/">Sell an Item</a>
                <a href="/dashboard/">My Dashboard</a>
                <a href="https://gigs.kabaleonline.com" class="service-link">Offer a Service</a>
                <a href="/blog/">Seller Tips</a>
            </div>
            <div class="footer-column">
                <h3>Company</h3>
                <a href="/about.html">About Us</a>
                <a href="/contact.html">Contact</a>
                <a href="/terms.html">Terms of Service</a>
                <a href="/blog/">Blog & News</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p class="footer-copyright">&copy; 2025 Kabale Online. All Rights Reserved.</p>
        </div>
    </footer>

    <!-- (Modals) -->
    <div id="nav-modal" class="nav-modal">
        <div class="nav-modal-content">
            <h3>Confirm Navigation</h3>
            <p id="nav-modal-message"></p>
            <div class="nav-modal-buttons">
                <button id="nav-cancel-btn" class="nav-modal-btn btn-cancel">Stay Here</button>
                <a id="nav-confirm-btn" class="nav-modal-btn btn-confirm">Proceed</a>
            </div>
        </div>
    </div>

    <!-- NEW: AI Chat Bubble -->
    <div id="ai-chat-bubble" class="ai-chat-bubble">
        <div class="ai-chat-bubble-avatar">
            <i class="fa-solid fa-headset"></i> <!-- Female avatar icon -->
        </div>
        <span class="ai-chat-bubble-text">Ask me anything...</span>
        <button id="ai-bubble-close" aria-label="Dismiss chat bubble">&times;</button>
    </div>

    <!-- AI Chat Modal -->
    <div id="chat-modal-container">
        <div class="chat-modal-overlay"></div>
        <div class="chat-modal-content">
            <div class="chat-modal-header">
                <h3>Amara</h3>
                <button id="close-chat-button" aria-label="Close Chat"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <iframe id="chat-iframe" src="/ai/" title="KabaleOnline AI Assistant"></iframe>
            <div id="resize-handle"></div> 
        </div>
    </div>

    <script type="module" src="index.js"></script>
</body>
</html>