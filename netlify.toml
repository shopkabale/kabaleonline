# netlify.toml (Final Corrected Version)

[build]
  functions = "netlify/functions/"
  publish = "."

# This section tells Netlify how to handle your functions.
[functions]
  node_bundler = "esbuild"
  # This new line tells the bundler to NOT bundle the Dialogflow library.
  external_node_modules = ["@google-cloud/dialogflow"]

# --- THIS IS THE NEW RULE FOR YOUR STORE ---
# This block tells Netlify how to handle your clean URLs.
[[redirects]]
  from = "/store/:username"
  to = "/store/index.html?username=:username"
  status = 200