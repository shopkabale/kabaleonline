<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Your Profile | Kabale Online</title>
<meta name="robots" content="noindex">
<link rel="stylesheet" href="../styles.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<style>
:root { 
    --primary-color: #007bff; 
    --accent-color: #ffc107; 
    --text-dark: #34495e; 
    --border-color: #e9ecef;
    --button-hover-dark: #0056b3;
    --cancel-button-dark: #5a6268;
}
body { padding-top: 70px; font-family: Arial, sans-serif; }
.sticky-header { position: fixed; top: 0; left: 0; right: 0; z-index: 1000; background-color: #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
.header-top-bar { display: flex; justify-content: space-between; align-items: center; padding: 0 15px; height: 50px; }
.hamburger-menu { font-size: 24px; background: none; border: none; cursor: pointer; color: var(--text-dark); }
.site-title { text-decoration: none; color: var(--text-dark); font-size: 1.6em; font-weight: bold; }
.site-title span { color: var(--accent-color); }
.header-icons { display: flex; align-items: center; gap: 20px; }
.header-icons a { color: var(--text-dark); font-size: 22px; text-decoration: none; }
.desktop-nav { display: none; }
.mobile-nav { position: fixed; top: 0; left: -260px; width: 260px; height: 100%; background-color: #fff; box-shadow: 2px 0 10px rgba(0,0,0,0.2); z-index: 1100; padding-top: 60px; transition: left 0.3s ease; }
.mobile-nav.active { left: 0; }
.mobile-nav a { display: flex; align-items: center; padding: 15px 20px; color: #333; text-decoration: none; border-bottom: 1px solid #f0f0f0; font-size: 1em; }
.mobile-nav a i { margin-right: 15px; font-size: 18px; color: #007bff; }
.mobile-nav a.post-button, .mobile-nav a.login-button { font-weight: bold; color: #007bff; }
.mobile-nav a:hover { background-color: #f8f9fa; }
.mobile-nav-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1050; display: none; }
.mobile-nav-overlay.active { display: block; }
.error-message, .success-message { display: none; border-radius: 5px; padding: 10px; text-align: center; margin: 10px 0; font-weight: bold; font-size: 0.9em; }
.error-message { color: #D8000C; background-color: #FFD2D2; border: 1px solid #D8000C; }
.success-message { color: #270; background-color: #DFF2BF; border: 1px solid #4F8A10; }
.loader { width: 18px; height: 18px; border: 2px solid #FFF; border-bottom-color: transparent; border-radius: 50%; display: inline-block; box-sizing: border-box; animation: rotation 1s linear infinite; margin-right: 8px; }
@keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
.auth-button.loading, .cta-button.loading { display: flex; align-items: center; justify-content: center; opacity: 0.8; cursor: not-allowed; }

/* PROFILE PAGE STYLES */
.profile-card { background-color: #fff; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); padding: 30px; margin-top: 20px; }
.profile-header { text-align: center; margin-bottom: 25px; }
.profile-header img { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 4px solid var(--primary-color); }
.profile-info-item { display: flex; justify-content: space-between; padding: 15px 0; border-bottom: 1px solid #e9ecef; }
.profile-info-item:last-child { border-bottom: none; }
.profile-info-item .label { font-weight: bold; color: var(--text-dark); }
.profile-info-item .value { color: #6c757d; text-align: right; word-break: break-all; }
.profile-actions { text-align: center; margin-top: 30px; }
.form-actions { display: flex; gap: 10px; justify-content: center; margin-top: 20px; }
.hidden { display: none !important; }
.glowing-btn { animation: glowing 2s infinite; }
@keyframes glowing { 0% { box-shadow: 0 0 5px var(--primary-color), 0 0 10px var(--primary-color); } 50% { box-shadow: 0 0 20px var(--primary-color), 0 0 30px var(--primary-color); } 100% { box-shadow: 0 0 5px var(--primary-color), 0 0 10px var(--primary-color); } }

/* Profile Form Styling */
#profile-form .form-group { margin-bottom: 20px; }
#profile-form label { display: block; margin-bottom: 8px; font-weight: bold; color: var(--text-dark); }
#profile-form input[type="text"], #profile-form input[type="email"], #profile-form textarea { width: 100%; padding: 12px; border: 1px solid #ced4da; border-radius: 8px; font-size: 1em; box-sizing: border-box; }
#profile-form input[type="file"] { display: block; margin-top: 5px; }
#profile-form .cta-button { flex: 1; padding: 12px 20px; font-size: 1.1em; font-weight: bold; border-radius: 8px; cursor: pointer; background-color: var(--primary-color); color: white; border: none; transition: background-color 0.2s; }
#profile-form .cta-button:hover { background-color: var(--button-hover-dark); }
#profile-form .auth-button { flex: 1; padding: 12px 20px; font-size: 1.1em; font-weight: bold; border-radius: 8px; cursor: pointer; background-color: #6c757d; color: white; border: none; transition: background-color 0.2s; }
#profile-form .auth-button:hover { background-color: var(--cancel-button-dark); }

/* Bouncing Loader Animation */
.bouncing-dots { text-align: center; padding: 20px; font-size: 1.2em; color: var(--primary-color); }
.bouncing-dots span { display: inline-block; animation: bounce 1.4s infinite ease-in-out both; margin: 0 2px; }
.bouncing-dots span:nth-child(1) { animation-delay: -0.32s; }
.bouncing-dots span:nth-child(2) { animation-delay: -0.16s; }
.bouncing-dots span:nth-child(3) { animation-delay: 0s; }
@keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }

.privacy-note { font-size: 0.85em; color: #555; margin-top: 15px; }
</style>
</head>
<body>
<header class="sticky-header">
  <div class="header-top-bar">
    <button class="hamburger-menu">&#9776;</button>
    <a href="/" class="site-title">Kabale <span>Online</span></a>
    <div class="header-icons">
      <a href="/dashboard/"><i class="fa-regular fa-user"></i></a>
      <a href="/upload/"><i class="fa-solid fa-plus"></i></a>
    </div>
  </div>
  <nav class="mobile-nav">
      <a href="/" class="nav-link"><i class="fa-solid fa-store"></i> All Items</a>
      <a href="/?type=service" class="nav-link"><i class="fa-solid fa-screwdriver-wrench"></i> Services</a>
      <a href="/rentals/" class="nav-link"><i class="fa-solid fa-building"></i> Hostels & Rentals</a>
      <a href="/requests/view.html" class="nav-link"><i class="fa-solid fa-clipboard-list"></i> User Requests</a>
      <a href="/lost-and-found/" class="nav-link"><i class="fa-solid fa-magnifying-glass"></i> Lost & Found</a>
      <a href="/blog/" class="nav-link"><i class="fa-solid fa-book"></i> Tips</a>
      <hr>
      <a href="/upload/" class="nav-link post-button"><i class="fa-solid fa-circle-plus"></i> Post Something</a>
      <a href="/login/" class="nav-link login-button"><i class="fa-solid fa-key"></i> Login</a>
  </nav>
  <div class="mobile-nav-overlay"></div>
</header>

<div class="container page-content">
  <a href="/dashboard/" class="home-link">&larr; Back to Dashboard</a>
  <h1>Your Profile</h1>

  <div id="profile-loader" class="bouncing-dots">
      <span>.</span><span>.</span><span>.</span>
  </div>

  <div id="profile-content" class="hidden">
    <p id="profile-update-message" style="display: none;"></p>

    <div class="profile-card">
      <div id="profile-display-view">
        <div class="profile-header">
          <img id="display-photo" src="https://placehold.co/120x120/e0e0e0/777?text=U" alt="Profile photo">
        </div>
        <div class="profile-info">
          <div class="profile-info-item"><span class="label">Full Name</span><span id="display-name" class="value"></span></div>
          <div class="profile-info-item"><span class="label">Email</span><span id="display-email" class="value"></span></div>
          <div class="profile-info-item"><span class="label">WhatsApp</span><span id="display-whatsapp" class="value"></span></div>
          <div class="profile-info-item"><span class="label">Phone</span><span id="display-phone" class="value"></span></div>
          <div class="profile-info-item"><span class="label">Location</span><span id="display-location" class="value"></span></div>
          <div class="profile-info-item"><span class="label">Bio</span><span id="display-bio" class="value"></span></div>
          <div class="profile-info-item"><span class="label">Profession</span><span id="display-profession" class="value"></span></div>
          <div class="profile-info-item"><span class="label">Facebook</span><span id="display-facebook" class="value"></span></div>
          <div class="profile-info-item"><span class="label">Instagram</span><span id="display-instagram" class="value"></span></div>
          <div class="profile-info-item"><span class="label">LinkedIn</span><span id="display-linkedin" class="value"></span></div>
        </div>
        <div class="profile-actions">
          <button id="edit-profile-btn" class="cta-button glowing-btn">Edit Profile</button>
        </div>
      </div>

      <form id="profile-form" class="hidden">
        <div class="form-group">
          <label for="profile-photo">Change Profile Photo</label>
          <input type="file" id="profile-photo" accept="image/*">
        </div>
        <div class="form-group"><label for="profile-name">Full Name (Required)</label><input type="text" id="profile-name" required></div>
        <div class="form-group"><label for="profile-email">Email (Required)</label><input type="text" id="profile-email" disabled></div>
        <div class="form-group"><label for="profile-whatsapp">WhatsApp (Required)</label><input type="text" id="profile-whatsapp" required></div>
        <div class="form-group"><label for="profile-phone">Phone (Optional)</label><input type="text" id="profile-phone"></div>
        <div class="form-group"><label for="profile-location">Location (Required)</label><input type="text" id="profile-location" required></div>
        <div class="form-group"><label for="profile-bio">Short Bio (Optional)</label><textarea id="profile-bio" rows="3"></textarea></div>
        <div class="form-group"><label for="profile-profession">Profession (Optional)</label><input type="text" id="profile-profession"></div>
        <div class="form-group"><label for="profile-facebook">Facebook (Optional)</label><input type="text" id="profile-facebook"></div>
        <div class="form-group"><label for="profile-instagram">Instagram (Optional)</label><input type="text" id="profile-instagram"></div>
        <div class="form-group"><label for="profile-linkedin">LinkedIn (Optional)</label><input type="text" id="profile-linkedin"></div>
        <div class="privacy-note">
          All required information will be used to contact you only when necessary or in emergencies. If we can't reach you via the required information, optional information (if provided) will be used. <br>
          <strong>Note:</strong> Privacy is our number one priority; we will never reveal personal data without your permission. Thank you.
        </div>
        <div class="form-actions">
          <button type="submit" id="update-profile-btn" class="cta-button">Save Changes</button>
          <button type="button" id="cancel-edit-btn" class="auth-button">Cancel</button>
        </div>
      </form>
    </div>

    <hr style="margin: 30px 0;">

    <div class="profile-card">
      <h2>Account Security</h2>
      <button id="reset-password-btn" class="auth-button">Change Password</button>
      <p class="instruction-text" style="font-size: 0.9em; margin-top: 5px;">We'll send a password reset link to your email address.</p>
    </div>
  </div>
</div>

<footer>
  <div class="kabale-contact-info-section">
      <h3 class="kabale-contact-title">Get in Touch</h3>
      <div class="kabale-contact-details">
          <p class="kabale-contact-item">ðŸ“ž +256 784655792</p>
          <p class="kabale-contact-item">ðŸ“§ shopkabale@gmail.com</p>
      </div>
      <div class="kabale-footer-links">
          <a href="/about.html" class="kabale-footer-link">About Us</a>
          <a href="/blog/" class="kabale-footer-link">Blog & Tips</a>
          <a href="/terms.html" class="kabale-footer-link">Terms of Service</a>
      </div>
  </div>
  <p class="copyright">&copy; 2025 Kabale Online. All Rights Reserved.</p>

  <!-- Services Redirect Modal -->
  <div id="service-notice" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
      background:rgba(0,0,0,0.6); justify-content:center; align-items:center; z-index:1000;">
    <div style="background:#fff; padding:30px 40px; border-radius:12px; text-align:center; max-width:400px; 
      box-shadow:0 5px 20px rgba(0,0,0,0.3); font-family:Arial,sans-serif; animation:fadeIn 0.3s ease-out;">
      <h3 style="margin-bottom:15px; color:#333;">Notice</h3>
      <p style="margin-bottom:20px; color:#555;">You are being redirected to <strong>Gigs.kabaleonline.com</strong> for Services.</p>
      <button id="continue-btn" style="padding:10px 20px; background:#007bff; border:none; border-radius:8px; 
        color:#fff; font-weight:bold; cursor:pointer; transition:background 0.3s;">Continue</button>
    </div>
  </div>

  <style>
    @keyframes fadeIn { from { opacity:0; transform: scale(0.8); } to { opacity:1; transform: scale(1); } }
    #continue-btn:hover { background:#0056b3; }
  </style>
</footer>

<script type="module" src="../js/shared.js"></script>
<script type="module" src="script.js"></script>
<script type="module" src="../js/ui.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const serviceLinks = document.querySelectorAll('a[href="/?type=service"]');
  const modal = document.getElementById('service-notice');
  const continueBtn = document.getElementById('continue-btn');

  serviceLinks.forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      modal.style.display = 'flex';
    });
  });

  continueBtn.addEventListener('click', function() {
    window.location.href = 'https://gigs.kabaleonline.com';
  });

  // Mobile nav toggle
  const hamburger = document.querySelector('.hamburger-menu');
  const mobileNav = document.querySelector('.mobile-nav');
  const overlay = document.querySelector('.mobile-nav-overlay');

  function toggleMobileNav() {
    mobileNav.classList.toggle('active');
    overlay.classList.toggle('active');
  }

  hamburger.addEventListener('click', toggleMobileNav);
  overlay.addEventListener('click', toggleMobileNav);
});
</script>
</body>
</html>