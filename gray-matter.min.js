!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.grayMatter=t()}(this,function(){"use strict";function e(e){return e.displayName||e.name||null}function t(e){return"string"==typeof e?e.replace(/^\s+|\s+$/g,""):""}function r(e){var r=/^((?: DRAFT:)? new) post(?: "(.*)")?$/i.exec(e);return r?(r[1]=r[1].toLowerCase(),("draft: new"===r[1]||" new"===r[1]&&!0)&&(r[1]=" new"),r):null}function n(e,r){var n={};if(e)for(var i in e)o.call(e,i)&&(n[i]=e[i]);if(r)for(var i in r)o.call(r,i)&&(n[i]=r[i]);return n}function i(e){return e.split(/\r\n|\r|\n/)}var o=Object.prototype.hasOwnProperty;var a={};function s(e){return e.replace(/\\`|\\{|\\}/g,function(e){return"\\`"===e?"`":"{"===e.slice(1)?"{":"}"})}function c(e,r){var n,o="---",a="---",s=!1,c=!1;if(r&&r.delims&&(o=Array.isArray(r.delims)?r.delims[0]:r.delims,a=Array.isArray(r.delims)?r.delims[1]:r.delims),n=Array.isArray(r.delimiters)?r.delimiters[0]:r.delimiters,Array.isArray(r.delimiters)&&(o=r.delimiters[0],a=r.delimiters[1]),e.startsWith(o)||(n&&e.startsWith(n)&&(o=n,a=n)),e.startsWith(o))){for(var l=o.length,u=e.length,p=l;p<u;p++){var f=e.charAt(p);if(c){if(" "===f)continue;if("\n"===f||"\r"===f){c=!1;continue}s=!0;break}if(s){if(e.startsWith(a,p))return{matter:t(e.slice(l,p)),body:e.slice(p+a.length)}}else"\n"!==f&&"\r"!==f||(s=!0,p--)}if(s)return{matter:"",body:e.slice(l)}}return null}function l(e){if(e&&"string"==typeof e){var r=i(e);if(0===r.length)return{data:{},content:e,excerpt:""};var n=c(e);if(n){var o=n.matter,a=n.body,s=t(a),l=s.indexOf("\n");return l!==-1&&(l=s.indexOf("\n",l+1)),{data:u(o),content:a,excerpt:-1!==l?s.slice(0,l):""}}var p=r.join("\n");return{data:{},content:p,excerpt:""}}return{data:{},content:e,excerpt:""}}function u(e){if("string"!=typeof e)throw new TypeError("expected a string");if(e=t(e),""===e)return{};for(var r=i(e),n={},o=0,a=r.length;o<a;o++){var s=r[o].indexOf(":");if(-1!==s){var c=t(r[o].slice(0,s)),l=t(r[o].slice(s+1));n[c]=l}}return n}a.parse=l;var p,f=function(e,t){return void 0===t&&(t={}),a.parse(e,t)},d=/^---\s*$/m,h=/^---\s*$/m;function m(e){return"string"==typeof e?e.replace(/^-{3}(?:\r\n|\r|\n)/,""):e}function g(e){var r,n,o;if(e.startsWith("---\n")||d.test(e)){r=e.split(/^-{3}/m);var i=r[1];if(i){var a=i.split(/\r\n|\r|\n/);a.shift();for(var s=0,c=a.length;s<c;s++){var l=a[s];if(l.startsWith("---\n")||h.test(l)){n=t(a.slice(0,s).join("\n"));var u=r.slice(2).join("---");o=m(t(u));break}}}else o=m(e)}else o=m(e);return{data:n,content:o}}function b(e){if(g(e)){for(var r,n=i(e),o=0,a=n.length;o<a;o++)if(n[o].startsWith("---")){r=o;break}if(void 0!==r)return n.slice(0,r+1).join("\n")}return""}var y={};y.test=function(e){return d.test(e)};var v=f;v.stringify=function(){throw new Error("not implemented")},v.test=function(){return!0};var w={};w.test=function(e){return/^\s*"),n=t(r[0].slice(5)),o=t(r.slice(1).join("-->"));return{data:n,content:o}};var x={};function k(e,r){var n=c(e,r);if(n){var o=n.matter.split(/:(.*)/);if(2===o.length){var a=t(o[0]);try{var s=JSON.parse(t(o[1]))}catch(e){throw new Error("invalid JSON in front-matter")}return{data:s,content:t(n.body),lang:a}}}return{data:{},content:e}}x.parse=function(e,r){var n,i=c(e,r);if(i){var o=i.matter;if(o.startsWith("{")&&o.endsWith("}"))try{n=JSON.parse(o)}catch(e){throw new Error("invalid JSON in front-matter")}else n=u(o);var a=t(i.body),s=a.indexOf("\n");return-1!==s&&(s=a.indexOf("\n",s+1)),{data:n,content:a,excerpt:-1!==s?a.slice(0,s):""}}return{data:{},content:e,excerpt:""}};try{p=require("js-yaml")}catch(e){}var O={};function _(e,r,n){if(null==p)throw new Error("js-yaml is not installed");var i=c(e,n);if(i){var o=i.matter,a=t(i.body);try{var s=p.safeLoad(o,r);return{data:s,content:a,excerpt:P(a)}}catch(e){throw new Error("gray-matter cannot parse: "+e.message)}}return{data:{},content:e,excerpt:""}}function P(e){var r=i(e),n=r.indexOf("---");return-1!==n&&(r=r.slice(0,n)),r.join("\n").trim()}O.parse=_,O.stringify=function(e,r,n){var i=p.safeDump(r,n);return"---\n"+i+"---\n\n"+e};var j={yaml:O,json:x,javascript:k,toml:{parse:function(){throw new Error("not implemented")}},gfm:y,front:a,"json-front-matter":x,"js-front-matter":k,"yaml-front-matter":O,html:w,"default":O},N=/^(?:\uFEFF|\u0000)?/,q=/^(?:(\s*---\s*))([\s\S]+?)(?:---\s*)|(?:()|(?:(;\s*;)[\s\S]+?(?:;;[\s\S]+?))$/;function D(e){if("string"!=typeof e)throw new TypeError("expected a string");var r=e.match(q);return!(!r||""!==r[r.length-1].trim())}var E=f;function S(r,n){if("string"!=typeof r)throw new TypeError("gray-matter expects a string.");var o=(n=n||{}).language||n.lang||"yaml",a=j[o]||j.default,s=a.parse;if("function"!=typeof s)throw new TypeError('gray-matter parser "'+o+'" is not a function.');var c=s(r.replace(N,""),n.options||n,n);return{data:c.data||{},content:c.content||r,excerpt:c.excerpt,language:o,matter:c.matter||"",stringify:function(e){var t=n.language||"yaml",r=j[t]||j.default,o=r.stringify;if("function"!=typeof o)throw new Error('the stringify method for language "'+t+'" is not implemented.');return o(c.content,e,n.options)}}}return S.read=function(){throw new Error("not implemented")},S.stringify=function(r,n,o){"string"==typeof r&&(o=n,n=r,r={});var a,s=(o=o||{}).language||"yaml",c=j[s]||j.default;if("object"==typeof c&&"function"==typeof c.stringify&&(a=c.stringify(n,r,o.options)),"string"!=typeof a&&(a=e(c)),"function"!=typeof a)throw new Error("language '"+s+"' is not supported.");var l=a(r,o.options);return l.endsWith("\n")||(l+="\n"),n?l+n:l},S.test=D,S.cache={},S});
